
# THIS is COUNTRY scope
# Инициализирует энергосеть для всех стейтов, контролируемых страной, на энергосеть данной страны
init_country_energy_system_all_states = {
	every_controlled_state = {
		set_variable = { energy_system_tag = PREV }
		owner = { add_to_array = { energy_system_states_ids = PREV } }
	}
}

# THIS is country scope
# Высчитывает состояние энергосети в стране
calculate_energy_in_country = {
	# Обнулям данные с предыдущего тика вычислений в стране
	precalculate_energy_in_country = yes

	# Вычисляем состояние энергосистемы, считая генерацию, потребление и передачу энергии в стейтах
	for_each_scope_loop = {
		array = energy_system_states_ids
		precalculate_energy_state_tick = yes
	}

	# Вычисляем эффекты на стейтах
	for_each_scope_loop = {
		array = energy_system_states_ids		
		postcalculate_energy_state_tick = yes
	}

	# 
	postcalculate_energy_in_country = yes
}